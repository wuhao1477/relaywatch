#!/bin/sh

# 无线 hotplug 钩子：监听关联/断开等事件并通知守护进程。

PROG="/usr/sbin/relaywatchd"
EVENT="${ACTION:-unknown}"
DEVICE="${DEVICE:-}"
IFACE="${INTERFACE:-}"

# 仅处理我们关心的状态变更事件
case "$EVENT" in
        connected|disconnected|assoc|disassoc|up|down)
                ;;
        *)
                exit 0
        ;;
esac

# 后台调用守护进程的通知接口，触发快速检测
if [ -x "$PROG" ]; then
        "$PROG" --notify "$EVENT" "${IFACE:-$DEVICE}" >/dev/null 2>&1 &
fi

exit 0
